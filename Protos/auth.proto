syntax = "proto3";

option csharp_namespace = "PingChatApp.Common.Protos";
option go_package = "github.com/PingChatApp/Common/out/pb";

package auth;

service AuthDataService {
    // client credentials flow
    rpc GetClient(GetClientRequest) returns (ClientResponse);
    rpc ResolveClientAuthorization(ResolveClientAuthRequest) returns (ResolvedClientAuthorization);

    // password flow
    rpc GetUserByUsername(GetUserRequest) returns (UserResponse);
    rpc ValidateUserCredentials(ValidateUserRequest) returns (ValidateUserResponse);
    rpc GetUserRoles(GetUserRolesRequest) returns (UserRolesResponse);
}

message GetClientRequest { string client_id = 1; }
message ResolveClientAuthRequest { string client_id = 1; }

message Scope {
  string name = 1;
  string resource = 2;
}

message ClientResponse {
  string client_id = 1;
  string client_secret_hash = 2;
  bool is_active = 3;
  ClientType type = 4;
}

enum ClientType {
  UNKNOWN = 0;
  CONFIDENTIAL = 1;
  PUBLIC = 2;
}

message ResolvedClientAuthorization {
  string client_id = 1;
  repeated Scope scopes = 2;
}